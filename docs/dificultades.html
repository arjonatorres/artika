<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="language" content="en" />
        <link href="./assets/6c471775/css/bootstrap.css" rel="stylesheet">
<link href="./assets/56b3aef3/solarized_light.css" rel="stylesheet">
<link href="./assets/db50a6aa/style.css" rel="stylesheet">
<script src="./assets/10ac4175/jquery.js"></script>
<script src="./assets/6c471775/js/bootstrap.js"></script>
<script src="./assets/a2d7f37/jssearch.js"></script>    <title>Dificultades encontradas - Dificultades encontradas - Guía del proyecto</title>
</head>
<body>

<div class="wrap">
    <nav id="w10" class="navbar-inverse navbar-fixed-top navbar"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#w10-collapse"><span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span></button><a class="navbar-brand" href="./index.html">Guía del proyecto</a></div><div id="w10-collapse" class="collapse navbar-collapse"><ul id="w11" class="navbar-nav nav"><li><a href="./api/index.html">Class reference</a></li>
<li><a href="./README.html">Guide</a></li></ul><div class="navbar-form navbar-left" role="search">
  <div class="form-group">
    <input id="searchbox" type="text" class="form-control" placeholder="Search">
  </div>
</div>
</div></nav>
    <div id="search-resultbox" style="display: none;" class="modal-content">
        <ul id="search-results">
        </ul>
    </div>

    
<div class="row">
    <div class="col-md-2">
                <div id="navigation" class="list-group"><a class="list-group-item" href="#navigation-0" data-toggle="collapse" data-parent="#navigation">Descripción general <b class="caret"></b></a><div id="navigation-0" class="submenu panel-collapse collapse"><a class="list-group-item" href="./descripcion.html#funcionalidad-principal-de-la-aplicacion">Funcionalidad principal de la aplicación</a>
<a class="list-group-item" href="./descripcion.html#objetivos-generales">Objetivos generales</a>
<a class="list-group-item" href="./descripcion.html#url-del-repositorio">URL del repositorio</a>
<a class="list-group-item" href="./descripcion.html#url-de-la-documentacion">URL de la documentación</a></div>
<a class="list-group-item" href="#navigation-1" data-toggle="collapse" data-parent="#navigation">Instrucciones de instalación y despliegue <b class="caret"></b></a><div id="navigation-1" class="submenu panel-collapse collapse"><a class="list-group-item" href="./instalacion.html#en-local">En local</a>
<a class="list-group-item" href="./instalacion.html#en-la-nube">En la nube</a></div>
<a class="list-group-item" href="#navigation-2" data-toggle="collapse" data-parent="#navigation">Catálogo de requisitos <b class="caret"></b></a><div id="navigation-2" class="submenu panel-collapse collapse"><a class="list-group-item" href="./requisitos.html#cuadro-resumen">Cuadro resumen</a></div>
<a class="list-group-item" href="#navigation-3" data-toggle="collapse" data-parent="#navigation">Manual de usuario <b class="caret"></b></a><div id="navigation-3" class="submenu panel-collapse collapse"><a class="list-group-item" href="./manual.html">Manual de usuario</a></div>
<a class="list-group-item" href="#navigation-4" data-toggle="collapse" data-parent="#navigation">Decisiones adoptadas <b class="caret"></b></a><div id="navigation-4" class="submenu panel-collapse collapse"><a class="list-group-item" href="./decisiones.html">Decisiones adoptadas</a></div>
<a class="list-group-item active" href="#navigation-5" data-toggle="collapse" data-parent="#navigation">Dificultades encontradas <b class="caret"></b></a><div id="navigation-5" class="submenu panel-collapse collapse in"><a class="list-group-item active" href="./dificultades.html">Dificultades encontradas</a></div>
<a class="list-group-item" href="#navigation-6" data-toggle="collapse" data-parent="#navigation">Diagramas <b class="caret"></b></a><div id="navigation-6" class="submenu panel-collapse collapse"><a class="list-group-item" href="./diagramas.html#diagramas-de-clases">Diagramas de clases</a>
<a class="list-group-item" href="./diagramas.html#diagramas-de-estructura-logica-de-datos">Diagramas de estructura lógica de datos</a></div>
<a class="list-group-item" href="#navigation-7" data-toggle="collapse" data-parent="#navigation">Glosario de términos <b class="caret"></b></a><div id="navigation-7" class="submenu panel-collapse collapse"><a class="list-group-item" href="./glosario.html">Glosario de términos</a></div>
<a class="list-group-item" href="#navigation-8" data-toggle="collapse" data-parent="#navigation">Conclusiones <b class="caret"></b></a><div id="navigation-8" class="submenu panel-collapse collapse"><a class="list-group-item" href="./conclusiones.html">Conclusiones</a></div>
<a class="list-group-item" href="#navigation-9" data-toggle="collapse" data-parent="#navigation">Anexos <b class="caret"></b></a><div id="navigation-9" class="submenu panel-collapse collapse"><a class="list-group-item" href="./anexos.html">Anexos</a></div></div>    </div>
    <div class="col-md-9 guide-content" role="main">
        <h1>Dificultades encontradas <span id="dificultades-encontradas"></span><a href="#dificultades-encontradas" class="hashlink">&para;</a></h1><h4><strong>Envío de órdenes al servidor</strong> <span id="envio-de-ordenes-al-servidor"></span><a href="#envio-de-ordenes-al-servidor" class="hashlink">&para;</a></h4><p>A la hora de enviar una orden (on, off, subir y bajar persiana...) desde la aplicación al servidor (Raspberry) me encontré con la duda de cómo hacerlo. Después de mucho investigar decidí usar Curl, que hace el envío de una petición y permite el proceso de la respuesta.</p>
<p>El envío de los datos se hacen en formato JSON al igual que la respuesta dada por el servidor. Al final el servidor es un mero "puente" entre la aplicación y el Arduino, que es el que finalmente lleva a cabo la ejecución de la orden dada por la aplicación.</p>
<h4><strong>Sincronización de la base de datos con el estado real de los módulos</strong> <span id="sincronizacion-de-la-base-de-datos-con-el-estado-real-de-los-modulos"></span><a href="#sincronizacion-de-la-base-de-datos-con-el-estado-real-de-los-modulos" class="hashlink">&para;</a></h4><p>Cada vez que se manda una orden y ésta es llevada a cabo con éxito se actualiza la base de datos con el nuevo estado del módulo, pero si ese estado se modifica en la casa del usuario, la aplicación no se "entera" y se produce una ambigüedad en el estado.</p>
<p>Para solucionar este problema cada vez que se accede a la página "mi-casa" de la aplicación ésta conecta con el Arduino y actualiza el estado de todos los módulos en la base de datos, llevándose a cabo así la sincronización.</p>
<hr />
<h1>Elementos de innovación <span id="elementos-de-innovacion"></span><a href="#elementos-de-innovacion" class="hashlink">&para;</a></h1><h4><strong>Plantilla avanzada de Yii2</strong> <span id="plantilla-avanzada-de-yii2"></span><a href="#plantilla-avanzada-de-yii2" class="hashlink">&para;</a></h4><p>Se decidió el uso de esta plantilla ya que divide la aplicación en dos aplicaciones con partes en común, la parte de frontend y de backend. Debido a la naturaleza de mi aplicación esta división era ideal, al tener una parte para los usuarios y otra para el administrador.</p>
<p>Su configuración inicial fue un poco compleja, sobretodo para su despliegue en Heroku, ya que había que configurar muchos archivos para separar la parte de frontend con la de backend.</p>
<h4><strong>Uso de migraciones</strong> <span id="uso-de-migraciones"></span><a href="#uso-de-migraciones" class="hashlink">&para;</a></h4><p>De inicio la plantilla avanzada usa migraciones, y aprovechando esto decidí investigar por mi cuenta y usarlas en la aplicación. En seguida agradecí haber tomado esta decisión ya que permite la modificación de partes de la base de datos como si fueran módulos separados, permitiendo así una forma mucho más dinámica de incorporar nuevas tablas y datos sin modificar lo anterior.</p>
<h4><strong>Uso de Curl</strong> <span id="uso-de-curl"></span><a href="#uso-de-curl" class="hashlink">&para;</a></h4><p>A la hora de enviar las órdenes al servidor se decidió por esta tecnología debido a su facilidad de uso y porque se adaptaba perfectamente a lo que requería la aplicación en esa funcionalidad.</p>
<h4><strong>Uso de archivos con extensión GPX</strong> <span id="uso-de-archivos-con-extension-gpx"></span><a href="#uso-de-archivos-con-extension-gpx" class="hashlink">&para;</a></h4><p>Existe un apartado opcional en la aplicación que al final se llevó a cabo en la cual se permite visualizar una ruta en el Google Maps contenida en un fichero GPX, que es el formato estandar para guardar rutas. Al investigar pude descubrir que el archivo contiene información en formato XML de cada coordenada GPS, con su altitud y su instante de tiempo. Procesando esa información y trasladándola al Google Maps conseguí dibujar dicha ruta en el mapa.</p>
        <div class="toplink"><a href="#" class="h1" title="go to top"><span class="glyphicon glyphicon-arrow-up"></a></div>
    </div>
</div>


</div>

<footer class="footer">
        <p class="pull-right"><small>Page generated on Tue, 12 Jun 2018 11:45:36 +0000</small></p>
    Powered by <a href="http://www.yiiframework.com/" rel="external">Yii Framework</a></footer>

<script>jQuery(function ($) {
    var shiftWindow = function () { scrollBy(0, -50) };
    if (location.hash) setTimeout(shiftWindow, 1);
    window.addEventListener("hashchange", shiftWindow);
var element = document.createElement("script");
element.src = "./jssearch.index.js";
document.body.appendChild(element);

var searchBox = $('#searchbox');

// search when typing in search field
searchBox.on("keyup", function(event) {
    var query = $(this).val();

    if (query == '' || event.which == 27) {
        $('#search-resultbox').hide();
        return;
    } else if (event.which == 13) {
        var selectedLink = $('#search-resultbox a.selected');
        if (selectedLink.length != 0) {
            document.location = selectedLink.attr('href');
            return;
        }
    } else if (event.which == 38 || event.which == 40) {
        $('#search-resultbox').show();

        var selected = $('#search-resultbox a.selected');
        if (selected.length == 0) {
            $('#search-results').find('a').first().addClass('selected');
        } else {
            var next;
            if (event.which == 40) {
                next = selected.parent().next().find('a').first();
            } else {
                next = selected.parent().prev().find('a').first();
            }
            if (next.length != 0) {
                var resultbox = $('#search-results');
                var position = next.position();

//              TODO scrolling is buggy and jumps around
//                resultbox.scrollTop(Math.floor(position.top));
//                console.log(position.top);

                selected.removeClass('selected');
                next.addClass('selected');
            }
        }

        return;
    }
    $('#search-resultbox').show();
    $('#search-results').html('<li><span class="no-results">No results</span></li>');

    var result = jssearch.search(query);

    if (result.length > 0) {
        var i = 0;
        var resHtml = '';

        for (var key in result) {
            if (i++ > 20) {
                break;
            }
            resHtml = resHtml +
            '<li><a href="' + result[key].file.u.substr(3) +'"><span class="title">' + result[key].file.t + '</span>' +
            '<span class="description">' + result[key].file.d + '</span></a></li>';
        }
        $('#search-results').html(resHtml);
    }
});

// hide the search results on ESC
$(document).on("keyup", function(event) { if (event.which == 27) { $('#search-resultbox').hide(); } });
// hide search results on click to document
$(document).bind('click', function (e) { $('#search-resultbox').hide(); });
// except the following:
searchBox.bind('click', function(e) { e.stopPropagation(); });
$('#search-resultbox').bind('click', function(e) { e.stopPropagation(); });

});</script></body>
</html>
